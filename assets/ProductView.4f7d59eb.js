import{_ as O}from"./chat.e108b74e.js";import{_ as W,a as X,T as Z}from"./TheMoreProduct.47248b71.js";import{a as r,c as i,d as e,_ as ee,s as te,x as se,y as ae,z as oe,A as H,u as le,C as re,D as ne,f as ie,r as x,E as L,o as ce,F as ue,G as de,b as d,w,B as me,t as c,H as s,q as f,h as pe,I as j,J as _e,K as P,L as N,M as ge,P as ve,N as he,O as fe,Q as be}from"./index.3ac89205.js";import{_ as U}from"./SendProductMessage.dfa32eb7.js";import{u as ye,_ as xe}from"./TheModel.c682ca7f.js";import"./index.b7f7de49.js";import"./TheTextarea.1b001d5d.js";const we=""+new URL("exclamation-solid.0ec4ead1.svg",import.meta.url).href,ke=""+new URL("store-solid.29345756.svg",import.meta.url).href,Ie={class:"relative overflow-hidden pb-[56.25%]"},Ce={__name:"YouToLink",props:{data:String},setup(_){const k=`https://www.youtube.com/embed/${_.data}`;return(I,C)=>(r(),i("div",Ie,[e("iframe",{class:"absolute top-0 left-0 w-full h-full",width:"560",height:"315",src:k,title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""})]))}};const u=_=>(fe("data-v-43fb2b0e"),_=_(),be(),_),$e={class:"container pt-44 lg:pt-32 pb-10"},Se={class:"flex items-center"},He=u(()=>e("p",null,"\u2002/\u2002",-1)),Le={class:"flex flex-col lg:flex-row gap-8 items-stretch mb-20"},Me={class:"lg:w-2/5 flex flex-col"},Re={class:"font-bold text-2xl mb-3"},Be={class:"text-primary text-xl mb-5"},Ve={class:"mb-1"},Te={class:"mb-6"},je={class:"mb-6 whitespace-pre-line"},Pe={key:0,class:"flex items-center gap-8 my-5"},Ne=["src","alt"],Ue={class:"mb-2 text-lg"},Ae={class:"flex gap-3 relative px-2"},Fe=u(()=>e("p",{class:"toggle-text text-gray-500 text-sm absolute top-5 -left-[2px]"}," \u79C1\u8A0A ",-1)),qe=u(()=>e("p",{class:"toggle-text text-gray-500 text-sm absolute top-5 left-7"}," \u6AA2\u8209 ",-1)),ze=u(()=>e("img",{src:ke,alt:"more",class:"w-4 h-4"},null,-1)),De=u(()=>e("p",{class:"toggle-text text-gray-500 text-sm absolute top-5 left-14"}," \u5546\u54C1 ",-1)),Ee={class:"flex mt-auto item-center justify-center gap-5"},Qe={class:"flex items-center border-2 border-primary rounded-lg w-1/3 justify-center"},Ye={class:"flex-1 -order-1 lg:order-1"},Ge={class:"relative h-[490px] mb-5"},Je={key:0},Ke=["src","alt"],Oe=["src","alt"],We=["src","onClick"],Xe={class:"mb-20"},Ze=u(()=>e("p",{class:"mb-6 text-2xl pb-2 border-b-2 border-primary"},"\u554F\u8207\u7B54",-1)),et={key:0,class:"mb-6"},tt={class:"w-4/5 whitespace-pre"},st=u(()=>e("p",null,"\u554F\uFF1A",-1)),at={class:"ml-2 whitespace-pre-line"},ot={key:0,class:"ml-auto w-4/5 bg-gray-200 rounded-lg p-2 flex justify-end"},lt=u(()=>e("p",null,"\u5718\u4E3B\u7B54\uFF1A",-1)),rt={class:"ml-2 whitespace-pre-line"},nt={class:"bg-gray-100 rounded-lg p-6"},it=u(()=>e("p",{class:"text-xl mb-4"},"\u63D0\u51FA\u554F\u984C",-1)),ct=u(()=>e("p",{class:"mb-4"},"\u70BA\u4FDD\u969C\u6703\u54E1\u4EA4\u6613\u5B89\u5168\uFF0C\u7559\u8A00\u8ACB\u52FF\u586B\u5BEB\u500B\u4EBA\u8CC7\u6599\u3002",-1)),ut={class:"bg-white rounded-lg"},dt={__name:"ProductView",setup(_){const m=te(),{clickAddCartHandler:k}=se(),I=ae(),C=oe(),{getSellProdctHander:M}=I,{sellProduct:t}=H(I),{sumbitMessageHandler:A,getProductMessageHandler:$}=C,{messageProduct:R,messagePage:v}=H(C),{toggleShow:b}=H(ye()),{isLoginHandler:F}=le(),{createReporteHandler:q}=re(),{addChatUserHandler:z}=ne();M(m.params.id),$(m.params.id),ie(()=>m.params.id,o=>{o&&m.path.includes("/product")&&(M(o),$(o))});const S=x(!1),y=x(!1),p=x(1),g=L(()=>t!=null&&t.value.images?t==null?void 0:t.value.images.length:0),n=x(t.value.youtubeId?g.value+1:0),D=L(()=>n.value===0?t.value.image:t.value.images[n.value-1]),E=L(()=>{if(t!=null&&t.value.images)return`grid-template-columns: repeat(${g.value+1}, minmax(0, 1fr));`}),B=o=>{const h=!!t.value.youtubeId?g.value+1:g.value;o===1?n.value>=h?n.value=0:n.value++:n.value<=0?n.value=h:n.value--},V=o=>{if(p.value+o<=0){p.value=1;return}if(p.value+o>t.value.remaining){p.value=t.value.remaining;return}p.value+=o},Q=async o=>{S.value=!0;const a={message:o.message,prodcutId:m.params.id};await A(a),S.value=!1},Y=()=>{!F()||(b.value=!b.value)},G=async o=>{b.value=!b.value;const a={message:o.message,productId:m.params.id};q(a)},J=o=>{v.value.current=o,$(m.params.id)},K=async o=>{y.value=!0,await k(o),y.value=!1};return ce(()=>{n.value=t.value.youtubeId?g.value+1:0}),ue(()=>{v.value.current=1}),(o,a)=>{const h=de("RouterLink");return r(),i("div",$e,[d(me,{class:"mb-10"},{default:w(()=>[e("div",Se,[d(h,{to:"/",class:"text-primary font-bold break-normal hover:opacity-60"},{default:w(()=>[he("\u7CBE\u9078\u5718\u8CFC")]),_:1}),He,e("p",null,c(s(t).name),1)])]),_:1}),e("div",Le,[e("div",Me,[e("h1",Re,c(s(t).name),1),e("p",Be,"$"+c(s(t).price),1),e("p",Ve," \u92B7\u552E\u6578\u91CF\uFF1A"+c(s(t).maxNumber-s(t).remaining),1),e("p",Te,"\u5269\u9918\u6578\u91CF\uFF1A"+c(s(t).remaining),1),e("p",je,c(s(t).description),1),s(t).userId?(r(),i("div",Pe,[e("img",{src:s(t).userId.image,alt:s(t).userId.name,class:"w-16 h-16 rounded-full object-cover"},null,8,Ne),e("div",null,[e("p",Ue,c(s(t).userId.name),1),e("div",Ae,[e("img",{src:O,alt:"chat",class:"toggle w-4 hover:opacity-60 cursor-pointer",onClick:a[0]||(a[0]=l=>s(z)({toUserId:s(t).userId._id,name:s(t).userId.name,image:s(t).userId.image}))}),Fe,e("img",{src:we,alt:"\u6AA2\u8209",class:"toggle w-4 h-4 hover:opacity-60 cursor-pointer",onClick:Y}),qe,d(h,{to:`/memberhome/${s(t).userId._id}`,class:"toggle hover:opacity-60"},{default:w(()=>[ze]),_:1},8,["to"]),De])])])):f("",!0),e("div",Ee,[e("div",Qe,[e("img",{src:W,class:"w-5 hover:opacity-60 block mr-auto ml-2",onClick:a[1]||(a[1]=l=>V(-1)),alt:"\u6E1B\u5C11\u6578\u91CF",title:"\u6E1B\u5C11\u6578\u91CF"}),e("p",null,c(p.value),1),e("img",{src:X,class:"w-5 hover:opacity-60 block ml-auto mr-2",onClick:a[2]||(a[2]=l=>V(1)),alt:"\u589E\u52A0\u6578\u91CF",title:"\u589E\u52A0\u6578\u91CF"})]),d(pe,{text:"\u52A0\u5165\u8CFC\u7269\u8ECA",class:"w-1/3",disabled:y.value,loading:y.value,onClick:a[3]||(a[3]=l=>K({id:s(t)._id,quantity:p.value}))},null,8,["disabled","loading"])])]),e("div",Ye,[e("div",Ge,[n.value===s(g)+1?(r(),i("div",Je,[d(Ce,{data:s(t).youtubeId,class:"w-[90%] mx-auto"},null,8,["data"])])):(r(),i("img",{key:1,class:"rounded-xl object-contain w-[90%] h-full mx-auto lg:full mb-5",src:s(D),alt:s(t).name},null,8,Ke)),e("img",{src:j,alt:"arrow",class:"w-6 absolute top-1/2 left-0 -translate-y-1/2 hover:opacity-60",onClick:a[4]||(a[4]=l=>B(-1))}),e("img",{src:j,alt:"arrow",class:"w-6 absolute rotate-180 top-1/2 right-0 -translate-y-1/2 hover:opacity-60",onClick:a[5]||(a[5]=l=>B(1))})]),e("div",{class:"grid gap-2",style:_e(s(E))},[e("div",null,[e("img",{class:"w-full h-full object-cover",src:s(t).image,alt:s(t).name,onClick:a[6]||(a[6]=l=>n.value=0)},null,8,Oe)]),s(t).images?(r(!0),i(P,{key:0},N(s(t).images,(l,T)=>(r(),i("div",null,[(r(),i("img",{src:l,key:T,class:"w-full h-full object-cover",onClick:mt=>n.value=T+1},null,8,We))]))),256)):f("",!0)],4)])]),e("div",Xe,[Ze,s(R).length?(r(),i("ul",et,[(r(!0),i(P,null,N(s(R),l=>(r(),i("li",{key:l._id,class:"border-2 rounded-lg mb-2 px-4 py-2"},[e("div",tt,[st,e("p",at,c(l.message),1)]),l.reply?(r(),i("div",ot,[lt,e("p",rt,c(l.reply||""),1)])):f("",!0)]))),128))])):f("",!0),s(v).total>1?(r(),ge(ve,{key:1,class:"ml-auto",total:s(v).total,current:s(v).current,onCurrent:J},null,8,["total","current"])):f("",!0),e("div",nt,[it,ct,e("div",ut,[d(U,{class:"lg:w-1/2 mx-auto pt-2 pb-12 px-8",classText:"h-52",onMessage:Q,isLoading:S.value},null,8,["isLoading"])])])]),d(xe,{classModel:"w-2/3 lg:w-1/2"},{default:w(()=>[d(U,{onMessage:G,class:"lg:w-2/3 mx-auto",classText:"h-40"})]),_:1}),d(Z,{category:s(t).category},null,8,["category"])])}}},yt=ee(dt,[["__scopeId","data-v-43fb2b0e"]]);export{yt as default};
